"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[2997],{5337:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"reference/routing-configuration/kubernetes/crd/http/serverstransport","title":"Kubernetes serversTransport","description":"The Kubernetes ServersTransport allows configuring the connection between Mesh and the HTTP servers in Kubernetes.","source":"@site/docs/reference/routing-configuration/kubernetes/crd/http/serverstransport.md","sourceDirName":"reference/routing-configuration/kubernetes/crd/http","slug":"/reference/routing-configuration/kubernetes/crd/http/serverstransport","permalink":"/doc/docs/reference/routing-configuration/kubernetes/crd/http/serverstransport","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/reference/routing-configuration/kubernetes/crd/http/serverstransport.md","tags":[],"version":"current","frontMatter":{"title":"Kubernetes serversTransport","description":"The Kubernetes ServersTransport allows configuring the connection between Mesh and the HTTP servers in Kubernetes."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh Kubernetes Middleware Documentation","permalink":"/doc/docs/reference/routing-configuration/kubernetes/crd/http/middleware"},"next":{"title":"TLSOption","permalink":"/doc/docs/reference/routing-configuration/kubernetes/crd/http/tlsoption"}}');var n=r(4848),i=r(8453);const l={title:"Kubernetes serversTransport",description:"The Kubernetes ServersTransport allows configuring the connection between Mesh and the HTTP servers in Kubernetes."},o=void 0,c={},d=[{value:"Configuration Example",id:"configuration-example",level:2},{value:"Configuration Options",id:"configuration-options",level:2}];function a(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["A ",(0,n.jsx)(t.code,{children:"ServersTransport"})," allows you to configure the connection between Mesh and the HTTP servers in Kubernetes."]}),"\n",(0,n.jsxs)(t.p,{children:["Before creating ",(0,n.jsx)(t.code,{children:"ServersTransport"})," objects, you need to apply the ",(0,n.jsx)(t.a,{href:"https://doc.Mesh.io/Mesh/reference/dynamic-configuration/kubernetes-crd/#definitions",children:"Mesh Kubernetes CRDs"})," to your Kubernetes cluster."]}),"\n",(0,n.jsxs)(t.p,{children:["This registers the ",(0,n.jsx)(t.code,{children:"ServersTransport"})," kind and other mesh-specific resources."]}),"\n",(0,n.jsx)(t.p,{children:"It can be applied on a service using:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The option ",(0,n.jsx)(t.code,{children:"services.serverstransport"})," on a ",(0,n.jsx)(t.a,{href:"/doc/docs/reference/routing-configuration/kubernetes/crd/http/ingressroute",children:(0,n.jsx)(t.code,{children:"IngressRoute"})})," (if the service is a Kubernetes Service)"]}),"\n",(0,n.jsxs)(t.li,{children:["The option ",(0,n.jsx)(t.code,{children:"serverstransport"})," on a ",(0,n.jsx)(t.a,{href:"./Meshservice.md",children:(0,n.jsx)(t.code,{children:"MeshService"})})," (if the service is a Kubernetes Service)"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:'!!! note "Reference a ServersTransport CRD from another namespace"'}),"\n",(0,n.jsxs)(t.p,{children:["The value must be of form ",(0,n.jsx)(t.code,{children:"namespace-name@kubernetescrd"}),", and the ",(0,n.jsx)(t.code,{children:"allowCrossNamespace"})," option must be enabled at the provider level."]}),"\n",(0,n.jsx)(t.h2,{id:"configuration-example",children:"Configuration Example"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:'tab="serversTransport"',children:"apiVersion: Mesh.io/v1alpha1\nkind: ServersTransport\nmetadata:\n  name: mytransport\n  namespace: default\n\nspec:\n  serverName: example.org\n  insecureSkipVerify: true\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:'tab="IngressRoute"',children:"apiVersion: Mesh.io/v1alpha1\nkind: IngressRoute\nmetadata:\n  name: testroute\n  namespace: default\n\nspec:\n  entryPoints:\n    - web\n  routes:\n  - match: Host(`example.com`)\n    kind: Rule\n    services:\n    - name: whoami\n      port: 80\n      serversTransport: mytransport\n"})}),"\n",(0,n.jsx)(t.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Field"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Required"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"serverName"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Defines the server name that will be used for SNI."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"insecureSkipVerify"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Controls whether the server's certificate chain and host name is verified."}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"false"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"rootcas"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Set of root certificate authorities to use when verifying server certificates. (for mTLS connections)."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"certificatesSecrets"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Certificates to present to the server for mTLS."}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"maxIdleConnsPerHost"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Maximum idle (keep-alive) connections to keep per-host."}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"200"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"disableHTTP2"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Disables HTTP/2 for connections with servers."}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"false"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"peerCertURI"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Defines the URI used to match against SAN URIs during the server's certificate verification."}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:'""'}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"forwardingTimeouts.dialTimeout"})]}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Amount of time to wait until a connection to a server can be established.",(0,n.jsx)("br",{}),"Zero means no timeout."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"30s"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"forwardingTimeouts.responseHeaderTimeout"})]}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Amount of time to wait for a server's response headers after fully writing the request (including its body, if any).",(0,n.jsx)("br",{}),"Zero means no timeout"]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"0s"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"forwardingTimeouts.idleConnTimeout"})]}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Maximum amount of time an idle (keep-alive) connection will remain idle before closing itself.",(0,n.jsx)("br",{}),"Zero means no timeout."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"90s"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"spiffe.ids"})]}),(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:["Allow SPIFFE IDs.",(0,n.jsx)("br",{}),"This takes precedence over the SPIFFE TrustDomain."]}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,n.jsx)(t.code,{children:"serverstransport."}),(0,n.jsx)("br",{}),(0,n.jsx)(t.code,{children:"spiffe.trustDomain"})]}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Allow SPIFFE trust domain."}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:'""'}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]})]})]}),"\n",(0,n.jsx)(t.p,{children:'!!! note "CA Secret"\nThe CA secret must contain a base64 encoded certificate under either a tls.ca or a ca.crt key.'})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>l,x:()=>o});var s=r(6540);const n={},i=s.createContext(n);function l(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);