"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[7055],{2390:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"reference/routing-configuration/tcp/service","title":"Mesh TCP Services Documentation","description":"A service is in charge of connecting incoming requests to the Servers that can handle them. Read the technical documentation.","source":"@site/docs/reference/routing-configuration/tcp/service.md","sourceDirName":"reference/routing-configuration/tcp","slug":"/reference/routing-configuration/tcp/service","permalink":"/doc/docs/reference/routing-configuration/tcp/service","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/reference/routing-configuration/tcp/service.md","tags":[],"version":"current","frontMatter":{"title":"Mesh TCP Services Documentation","description":"A service is in charge of connecting incoming requests to the Servers that can handle them. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"ServersTransport TCP","permalink":"/doc/docs/reference/routing-configuration/tcp/serverstransport"},"next":{"title":"Mesh TLS Documentation","permalink":"/doc/docs/reference/routing-configuration/tcp/tls"}}');var t=n(4848),i=n(8453);const c={title:"Mesh TCP Services Documentation",description:"A service is in charge of connecting incoming requests to the Servers that can handle them. Read the technical documentation."},o=void 0,a={},d=[{value:"General",id:"general",level:2},{value:"Servers Load Balancer",id:"servers-load-balancer",level:2},{value:"Configuration Examples",id:"configuration-examples",level:3},{value:"Configuration Options",id:"configuration-options",level:2},{value:"servers.proxyProtocol.version",id:"serversproxyprotocolversion",level:3},{value:"Weighted Round Robin",id:"weighted-round-robin",level:2}];function l(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h2,{id:"general",children:"General"}),"\n",(0,t.jsxs)(r.p,{children:["Each of the fields of the service section represents a kind of service. Which means, that for each specified service, one of the fields, and only one, has to be enabled to define what kind of service is created. Currently, the two available kinds are ",(0,t.jsx)(r.code,{children:"LoadBalancer"}),", and ",(0,t.jsx)(r.code,{children:"Weighted"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"servers-load-balancer",children:"Servers Load Balancer"}),"\n",(0,t.jsx)(r.p,{children:"The servers load balancer is in charge of balancing the requests between the servers of the same service."}),"\n",(0,t.jsx)(r.h3,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,t.jsxs)(r.p,{children:["Declaring a Service with Two Servers -- Using the ",(0,t.jsx)(r.a,{href:"/doc/docs/reference/install-configuration/providers/others/file",children:"File Provider"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",metastring:'tab="Structured (YAML)"',children:'tcp:\n  services:\n    my-service:\n      loadBalancer:\n        servers:\n        - address: "xx.xx.xx.xx:xx"\n        - address: "xx.xx.xx.xx:xx"\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-toml",metastring:'tab="Structured (TOML)"',children:'[tcp.services]\n  [tcp.services.my-service.loadBalancer]\n    [[tcp.services.my-service.loadBalancer.servers]]\n      address = "xx.xx.xx.xx:xx"\n    [[tcp.services.my-service.loadBalancer.servers]]\n        address = "xx.xx.xx.xx:xx"\n'})}),"\n",(0,t.jsx)(r.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Field"}),(0,t.jsx)(r.th,{children:"Description"}),(0,t.jsx)(r.th,{children:"Default"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"servers"})}),(0,t.jsx)(r.td,{children:"Servers declare a single instance of your program."}),(0,t.jsx)(r.td,{children:'""'})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"servers.address"})}),(0,t.jsxs)(r.td,{children:["The address option (IP",":Port",") point to a specific instance."]}),(0,t.jsx)(r.td,{children:'""'})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"servers.tls"})}),(0,t.jsxs)(r.td,{children:["The ",(0,t.jsx)(r.code,{children:"tls"})," option determines whether to use TLS when dialing with the backend."]}),(0,t.jsx)(r.td,{children:"false"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"servers.serversTransport"})}),(0,t.jsxs)(r.td,{children:[(0,t.jsx)(r.code,{children:"serversTransport"})," allows to reference a TCP [ServersTransport](./serverstransport.md configuration for the communication between Mesh and your servers. If no serversTransport is specified, the default@internal will be used."]}),(0,t.jsx)(r.td,{children:'""'})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"servers.proxyProtocol.version"})}),(0,t.jsxs)(r.td,{children:["Mesh supports PROXY Protocol version 1 and 2 on TCP Services. More Information ",(0,t.jsx)(r.a,{href:"#serversproxyprotocolversion",children:"here"})]}),(0,t.jsx)(r.td,{children:"2"})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"serversproxyprotocolversion",children:"servers.proxyProtocol.version"}),"\n",(0,t.jsxs)(r.p,{children:["Mesh supports ",(0,t.jsx)(r.a,{href:"https://www.haproxy.org/download/2.0/doc/proxy-protocol.txt",children:"PROXY Protocol"})," version 1 and 2 on TCP Services. It can be enabled by setting ",(0,t.jsx)(r.code,{children:"proxyProtocol"})," on the load balancer.\nThe option specifies the version of the protocol to be used. Either 1 or 2."]}),"\n",(0,t.jsx)(r.h2,{id:"weighted-round-robin",children:"Weighted Round Robin"}),"\n",(0,t.jsxs)(r.p,{children:["The Weighted Round Robin (alias ",(0,t.jsx)(r.code,{children:"WRR"}),") load-balancer of services is in charge of balancing the requests between multiple services based on provided weights."]}),"\n",(0,t.jsxs)(r.p,{children:["This strategy is only available to load balance between ",(0,t.jsx)(r.a,{href:"/doc/docs/reference/routing-configuration/tcp/service",children:"services"})," and not between servers."]}),"\n",(0,t.jsx)(r.p,{children:'!!! info "Supported Providers"'}),"\n",(0,t.jsxs)(r.p,{children:["This strategy can be defined currently with the ",(0,t.jsx)(r.a,{href:"/doc/docs/reference/install-configuration/providers/others/file",children:"File"})," or ",(0,t.jsx)(r.a,{href:"/doc/docs/reference/install-configuration/providers/kubernetes/kubernetes-crd",children:"IngressRoute"})," providers."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-yaml",metastring:'tab="Structured (YAML)"',children:'tcp:\n  services:\n    app:\n      weighted:\n        services:\n        - name: appv1\n          weight: 3\n        - name: appv2\n          weight: 1\n\n    appv1:\n      loadBalancer:\n        servers:\n        - address: "xxx.xxx.xxx.xxx:8080"\n\n    appv2:\n      loadBalancer:\n        servers:\n        - address: "xxx.xxx.xxx.xxx:8080"\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-toml",metastring:'tab="Structured (TOML)"',children:'[tcp.services]\n  [tcp.services.app]\n    [[tcp.services.app.weighted.services]]\n      name = "appv1"\n      weight = 3\n    [[tcp.services.app.weighted.services]]\n      name = "appv2"\n      weight = 1\n\n  [tcp.services.appv1]\n    [tcp.services.appv1.loadBalancer]\n      [[tcp.services.appv1.loadBalancer.servers]]\n        address = "private-ip-server-1:8080/"\n\n  [tcp.services.appv2]\n    [tcp.services.appv2.loadBalancer]\n      [[tcp.services.appv2.loadBalancer.servers]]\n        address = "private-ip-server-2:8080/"\n'})})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>c,x:()=>o});var s=n(6540);const t={},i=s.createContext(t);function c(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);