"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[3563],{4310:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"providers/kubernetes-crd","title":"Kubernetes IngressRoute & Mesh CRD","description":"The Mesh team developed a Custom Resource Definition (CRD) for an IngressRoute type, to provide a better way to configure access to a Kubernetes cluster.","source":"@site/docs/providers/kubernetes-crd.md","sourceDirName":"providers","slug":"/providers/kubernetes-crd","permalink":"/doc/docs/providers/kubernetes-crd","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/providers/kubernetes-crd.md","tags":[],"version":"current","frontMatter":{"title":"Kubernetes IngressRoute & Mesh CRD","description":"The Mesh team developed a Custom Resource Definition (CRD) for an IngressRoute type, to provide a better way to configure access to a Kubernetes cluster."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh HTTP Documentation","permalink":"/doc/docs/providers/http"},"next":{"title":"Mesh Kubernetes Gateway API Documentation","permalink":"/doc/docs/providers/kubernetes-gateway"}}');var t=s(4848),i=s(8453);const a={title:"Kubernetes IngressRoute & Mesh CRD",description:"The Mesh team developed a Custom Resource Definition (CRD) for an IngressRoute type, to provide a better way to configure access to a Kubernetes cluster."},o="Mesh & Kubernetes",c={},l=[{value:"Requirements",id:"requirements",level:2},{value:"Resource Configuration",id:"resource-configuration",level:2},{value:"LetsEncrypt Support with the Custom Resource Definition Provider",id:"letsencrypt-support-with-the-custom-resource-definition-provider",level:2},{value:"Provider Configuration",id:"provider-configuration",level:2},{value:"<code>endpoint</code>",id:"endpoint",level:3},{value:"<code>token</code>",id:"token",level:3},{value:"<code>certAuthFilePath</code>",id:"certauthfilepath",level:3},{value:"<code>namespaces</code>",id:"namespaces",level:3},{value:"<code>labelselector</code>",id:"labelselector",level:3},{value:"<code>ingressClass</code>",id:"ingressclass",level:3},{value:"<code>throttleDuration</code>",id:"throttleduration",level:3},{value:"<code>allowEmptyServices</code>",id:"allowemptyservices",level:3},{value:"<code>allowCrossNamespace</code>",id:"allowcrossnamespace",level:3},{value:"<code>allowExternalNameServices</code>",id:"allowexternalnameservices",level:3},{value:"<code>nativeLBByDefault</code>",id:"nativelbbydefault",level:3},{value:"Full Example",id:"full-example",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mesh--kubernetes",children:"Mesh & Kubernetes"})}),"\n",(0,t.jsx)(n.p,{children:"The Kubernetes Ingress Controller, The Custom Resource Way."}),"\n",(0,t.jsxs)(n.p,{children:["In early versions, Mesh supported Kubernetes only through the ",(0,t.jsx)(n.a,{href:"/doc/docs/providers/kubernetes-ingress",children:"Kubernetes Ingress provider"}),", which is a Kubernetes Ingress controller in the strict sense of the term."]}),"\n",(0,t.jsxs)(n.p,{children:["However, as the community expressed the need to benefit from Mesh features without resorting to (lots of) annotations,\nthe Mesh engineering team developed a ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/",children:"Custom Resource Definition"}),"\n(CRD) for an IngressRoute type, defined below, in order to provide a better way to configure access to a Kubernetes cluster."]}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(n.p,{children:'!!! tip "All Steps for a Successful Deployment"'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Add/update ",(0,t.jsx)(n.strong,{children:"all"})," the Mesh resources ",(0,t.jsx)(n.a,{href:"/doc/docs/reference/dynamic-configuration/kubernetes-crd#definitions",children:"definitions"})]}),"\n",(0,t.jsxs)(n.li,{children:["Add/update the ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/access-authn-authz/rbac/",children:"RBAC"})," for the Mesh custom resources"]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.a,{href:"../getting-started/install-Mesh.md#use-the-helm-chart",children:"Helm Chart"})," or use a custom Mesh Deployment","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enable the kubernetesCRD provider"}),"\n",(0,t.jsxs)(n.li,{children:["Apply the needed kubernetesCRD provider ",(0,t.jsx)(n.a,{href:"#provider-configuration",children:"configuration"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Add all necessary Mesh custom ",(0,t.jsx)(n.a,{href:"/doc/docs/reference/dynamic-configuration/kubernetes-crd#resources",children:"resources"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:'!!! example "Installing Resource Definition and RBAC"'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Install Mesh Resource Definitions:\nkubectl apply -f https://raw.githubusercontent.com/Mesh/Mesh/v3.4/docs/content/reference/dynamic-configuration/kubernetes-crd-definition-v1.yml\n\n# Install RBAC for Mesh:\nkubectl apply -f https://raw.githubusercontent.com/Mesh/Mesh/v3.4/docs/content/reference/dynamic-configuration/kubernetes-crd-rbac.yml\n"})}),"\n",(0,t.jsx)(n.h2,{id:"resource-configuration",children:"Resource Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["When using KubernetesCRD as a provider,\nMesh uses ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/",children:"Custom Resource Definition"})," to retrieve its routing configuration.\nMesh Custom Resource Definitions are a Kubernetes implementation of the Mesh concepts. The main particularities are:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The usage of ",(0,t.jsx)(n.code,{children:"name"})," ",(0,t.jsx)(n.strong,{children:"and"})," ",(0,t.jsx)(n.code,{children:"namespace"})," to refer to another Kubernetes resource."]}),"\n",(0,t.jsxs)(n.li,{children:["The usage of ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/secret/",children:"secret"})," for sensitive data (TLS certificates and credentials)."]}),"\n",(0,t.jsx)(n.li,{children:"The structure of the configuration."}),"\n",(0,t.jsxs)(n.li,{children:["The requirement to declare all the ",(0,t.jsx)(n.a,{href:"/doc/docs/reference/dynamic-configuration/kubernetes-crd#definitions",children:"definitions"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The Mesh CRDs are building blocks that you can assemble according to your needs.\nSee the list of CRDs in the dedicated ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/providers/kubernetes-crd",children:"routing section"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"letsencrypt-support-with-the-custom-resource-definition-provider",children:"LetsEncrypt Support with the Custom Resource Definition Provider"}),"\n",(0,t.jsx)(n.p,{children:"By design, Mesh is a stateless application, meaning that it only derives its configuration from the environment it runs in, without additional configuration.\nFor this reason, users can run multiple instances of Mesh at the same time to achieve HA, as is a common pattern in the kubernetes ecosystem."}),"\n",(0,t.jsxs)(n.p,{children:["When using a single instance of Mesh with Let's Encrypt, you should encounter no issues. However, this could be a single point of failure.\nUnfortunately, it is not possible to run multiple instances of Mesh Proxy 2.0 with Let's Encrypt enabled, because there is no way to ensure that the correct instance of Mesh will receive the challenge request and subsequent responses.\nEarly versions (v1.x) of Mesh used a ",(0,t.jsx)(n.a,{href:"https://doc.Mesh.io/Mesh/v1.7/configuration/acme/#storage",children:"KV store"})," to attempt to achieve this, but due to sub-optimal performance that feature was dropped in 2.0."]}),"\n",(0,t.jsxs)(n.p,{children:["If you need Let's Encrypt with HA in a Kubernetes environment, we recommend using ",(0,t.jsx)(n.a,{href:"https://Mesh.io/mesh-enterprise/",children:"Mesh Enterprise"}),", which includes distributed Let's Encrypt as a supported feature."]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to keep using Mesh Proxy, high availability for Let's Encrypt can be achieved by using a Certificate Controller such as ",(0,t.jsx)(n.a,{href:"https://cert-manager.io/docs/",children:"Cert-Manager"}),".\nWhen using Cert-Manager to manage certificates, it creates secrets in your namespaces that can be referenced as TLS secrets in your ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/ingress/#tls",children:"ingress objects"}),".\nWhen using the Mesh Kubernetes CRD Provider, unfortunately Cert-Manager cannot yet interface directly with the CRDs.\nA workaround is to enable the ",(0,t.jsx)(n.a,{href:"/doc/docs/providers/kubernetes-ingress",children:"Kubernetes Ingress provider"})," to allow Cert-Manager to create ingress objects to complete the challenges.\nPlease note that this still requires manual intervention to create the certificates through Cert-Manager, but once the certificates are created, Cert-Manager keeps them renewed."]}),"\n",(0,t.jsx)(n.h2,{id:"provider-configuration",children:"Provider Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"endpoint",children:(0,t.jsx)(n.code,{children:"endpoint"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"The Kubernetes server endpoint URL."}),"\n",(0,t.jsxs)(n.p,{children:["When deployed into Kubernetes, Mesh reads the environment variables ",(0,t.jsx)(n.code,{children:"KUBERNETES_SERVICE_HOST"})," and ",(0,t.jsx)(n.code,{children:"KUBERNETES_SERVICE_PORT"})," or ",(0,t.jsx)(n.code,{children:"KUBECONFIG"})," to construct the endpoint."]}),"\n",(0,t.jsxs)(n.p,{children:["The access token is looked up in ",(0,t.jsx)(n.code,{children:"/var/run/secrets/kubernetes.io/serviceaccount/token"})," and the SSL CA certificate in ",(0,t.jsx)(n.code,{children:"/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"}),".\nBoth are mounted automatically when deployed inside Kubernetes."]}),"\n",(0,t.jsx)(n.p,{children:"The endpoint may be specified to override the environment variable values inside a cluster."}),"\n",(0,t.jsxs)(n.p,{children:["When the environment variables are not found, Mesh tries to connect to the Kubernetes API server with an external-cluster client.\nIn this case, the endpoint is required.\nSpecifically, it may be set to the URL used by ",(0,t.jsx)(n.code,{children:"kubectl proxy"})," to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    endpoint: "http://localhost:8080"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  endpoint = "http://localhost:8080"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.endpoint=http://localhost:8080\n"})}),"\n",(0,t.jsx)(n.h3,{id:"token",children:(0,t.jsx)(n.code,{children:"token"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"Bearer token used for the Kubernetes client configuration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    token: "mytoken"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  token = "mytoken"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.token=mytoken\n"})}),"\n",(0,t.jsx)(n.h3,{id:"certauthfilepath",children:(0,t.jsx)(n.code,{children:"certAuthFilePath"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"Path to the certificate authority file.\nUsed for the Kubernetes client configuration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    certAuthFilePath: "/my/ca.crt"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  certAuthFilePath = "/my/ca.crt"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.certauthfilepath=/my/ca.crt\n"})}),"\n",(0,t.jsx)(n.h3,{id:"namespaces",children:(0,t.jsx)(n.code,{children:"namespaces"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: []"})}),"\n",(0,t.jsx)(n.p,{children:"Array of namespaces to watch.\nIf left empty, Mesh watches all namespaces."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    namespaces:\n    - "default"\n    - "production"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  namespaces = ["default", "production"]\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.namespaces=default,production\n"})}),"\n",(0,t.jsx)(n.h3,{id:"labelselector",children:(0,t.jsx)(n.code,{children:"labelselector"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsxs)(n.p,{children:["A label selector can be defined to filter on specific resource objects only,\nthis applies only to Mesh ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/providers/kubernetes-crd#custom-resource-definition-crd",children:"Custom Resources"}),"\nand has no effect on Kubernetes ",(0,t.jsx)(n.code,{children:"Secrets"}),", ",(0,t.jsx)(n.code,{children:"EndpointSlices"})," and ",(0,t.jsx)(n.code,{children:"Services"}),".\nIf left empty, Mesh processes all resource objects in the configured namespaces."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors",children:"label-selectors"})," for details."]}),"\n",(0,t.jsx)(n.p,{children:"!!! warning"}),"\n",(0,t.jsx)(n.p,{children:"Because the label selector is applied to all Mesh Custom Resources, they all must match the filter."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    labelSelector: "app=Mesh"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  labelSelector = "app=Mesh"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:'--providers.kubernetescrd.labelselector="app=Mesh"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"ingressclass",children:(0,t.jsx)(n.code,{children:"ingressClass"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsxs)(n.p,{children:["Value of ",(0,t.jsx)(n.code,{children:"kubernetes.io/ingress.class"})," annotation that identifies resource objects to be processed."]}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set, only resources containing an annotation with the same value are processed.\nOtherwise, resources missing the annotation, having an empty value, or the value ",(0,t.jsx)(n.code,{children:"Mesh"})," are processed."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    ingressClass: "mesh-internal"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  ingressClass = "mesh-internal"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.ingressclass=mesh-internal\n"})}),"\n",(0,t.jsx)(n.h3,{id:"throttleduration",children:(0,t.jsx)(n.code,{children:"throttleDuration"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: 0"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"throttleDuration"})," option defines how often the provider is allowed to handle events from Kubernetes. This prevents\na Kubernetes cluster that updates many times per second from continuously changing your Mesh configuration."]}),"\n",(0,t.jsx)(n.p,{children:"If left empty, the provider does not apply any throttling and does not drop any Kubernetes events."}),"\n",(0,t.jsxs)(n.p,{children:["The value of ",(0,t.jsx)(n.code,{children:"throttleDuration"})," should be provided in seconds or as a valid duration format,\nsee ",(0,t.jsx)(n.a,{href:"https://golang.org/pkg/time/#ParseDuration",children:"time.ParseDuration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesCRD:\n    throttleDuration: "10s"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesCRD]\n  throttleDuration = "10s"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.throttleDuration=10s\n"})}),"\n",(0,t.jsx)(n.h3,{id:"allowemptyservices",children:(0,t.jsx)(n.code,{children:"allowEmptyServices"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nit allows the creation of an empty ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/services/#servers-load-balancer",children:"servers load balancer"})," if the targeted Kubernetes service has no endpoints available.\nWith IngressRoute resources,\nthis results in ",(0,t.jsx)(n.code,{children:"503"})," HTTP responses instead of ",(0,t.jsx)(n.code,{children:"404"})," ones."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesCRD:\n    allowEmptyServices: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesCRD]\n  allowEmptyServices = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesCRD.allowEmptyServices=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"allowcrossnamespace",children:(0,t.jsx)(n.code,{children:"allowCrossNamespace"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nIngressRoute are able to reference resources in namespaces other than theirs."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesCRD:\n    allowCrossNamespace: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesCRD]\n  allowCrossNamespace = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.allowCrossNamespace=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"allowexternalnameservices",children:(0,t.jsx)(n.code,{children:"allowExternalNameServices"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),", IngressRoutes are able to reference ExternalName services."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesCRD:\n    allowExternalNameServices: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesCRD]\n  allowExternalNameServices = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.allowexternalnameservices=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nativelbbydefault",children:(0,t.jsx)(n.code,{children:"nativeLBByDefault"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["Defines whether to use Native Kubernetes load-balancing mode by default.\nFor more information, please check out the IngressRoute ",(0,t.jsx)(n.code,{children:"nativeLB"})," option ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/providers/kubernetes-crd#load-balancing",children:"documentation"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesCRD:\n    nativeLBByDefault: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesCRD]\n  nativeLBByDefault = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetescrd.nativeLBByDefault=true\n"})}),"\n",(0,t.jsx)(n.h2,{id:"full-example",children:"Full Example"}),"\n",(0,t.jsxs)(n.p,{children:["For additional information, refer to the ",(0,t.jsx)(n.a,{href:"/doc/docs/user-guides/crd-acme/",children:"full example"})," with Let's Encrypt."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var r=s(6540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);