"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[2775],{8453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>c});var r=n(6540);const i={},d=r.createContext(i);function s(e){const t=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(d.Provider,{value:t},e.children)}},8485:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"reference/routing-configuration/http/middlewares/redirectregex","title":"Mesh RedirectRegex Documentation","description":"In Mesh Proxy\'s HTTP middleware, RedirectRegex redirecting clients to different locations. Read the technical documentation.","source":"@site/docs/reference/routing-configuration/http/middlewares/redirectregex.md","sourceDirName":"reference/routing-configuration/http/middlewares","slug":"/reference/routing-configuration/http/middlewares/redirectregex","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/redirectregex","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/reference/routing-configuration/http/middlewares/redirectregex.md","tags":[],"version":"current","frontMatter":{"title":"Mesh RedirectRegex Documentation","description":"In Mesh Proxy\'s HTTP middleware, RedirectRegex redirecting clients to different locations. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh RateLimit Documentation","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/ratelimit"},"next":{"title":"Mesh RedirectScheme Documentation","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/redirectscheme"}}');var i=n(4848),d=n(8453);const s={title:"Mesh RedirectRegex Documentation",description:"In Mesh Proxy's HTTP middleware, RedirectRegex redirecting clients to different locations. Read the technical documentation."},c=void 0,l={},a=[{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Configuration Options",id:"configuration-options",level:2},{value:"<code>regex</code>",id:"regex",level:3},{value:"<code>replacement</code>",id:"replacement",level:3}];function o(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"RedirectRegex"})," redirects a request using regex matching and replacement."]}),"\n",(0,i.jsx)(t.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'tab="Structured (YAML)"',children:'# Redirect with domain replacement\nhttp:\n  middlewares:\n    test-redirectregex:\n      redirectRegex:\n        regex: "^http://localhost/(.*)"\n        replacement: "http://mydomain/${1}"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-toml",metastring:'tab="Structured (TOML)"',children:'# Redirect with domain replacement\n[http.middlewares]\n  [http.middlewares.test-redirectregex.redirectRegex]\n    regex = "^http://localhost/(.*)"\n    replacement = "http://mydomain/${1}"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'tab="Labels"',children:'# Redirect with domain replacement\n# Note: all dollar signs need to be doubled for escaping.\nlabels:\n  - "Mesh.http.middlewares.test-redirectregex.redirectregex.regex=^http://localhost/(.*)"\n  - "Mesh.http.middlewares.test-redirectregex.redirectregex.replacement=http://mydomain/$${1}"\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",metastring:'tab="Tags"',children:'// Redirect with domain replacement\n// Note: all dollar signs need to be doubled for escaping.\n{\n  // ...\n  "Tags" : [\n    "Mesh.http.middlewares.test-redirectregex.redirectregex.regex=^http://localhost/(.*)"\n    "Mesh.http.middlewares.test-redirectregex.redirectregex.replacement=http://mydomain/$${1}"\n  ]\n}\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"# Redirect with domain replacement\napiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-redirectregex\nspec:\n  redirectRegex:\n    regex: ^http://localhost/(.*)\n    replacement: http://mydomain/${1}\n"})}),"\n",(0,i.jsx)(t.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Field"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Required"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"regex"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["The ",(0,i.jsx)(t.code,{children:"regex"})," option is the regular expression to match and capture elements from the request URL."]}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:'""'}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"permanent"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Enable a permanent redirection."}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"false"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"replacement"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["The ",(0,i.jsx)(t.code,{children:"replacement"})," option defines how to modify the URL to have the new target URL..",(0,i.jsx)("br",{})," ",(0,i.jsx)(t.code,{children:"$1x"})," is equivalent to ",(0,i.jsx)(t.code,{children:"${1x}"}),", not ",(0,i.jsx)(t.code,{children:"${1}x"})," (see ",(0,i.jsx)(t.a,{href:"https://golang.org/pkg/regexp/#Regexp.Expand",children:"Regexp.Expand"}),"), so use ",(0,i.jsx)(t.code,{children:"${1}"})," syntax."]}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:'""'}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"regex",children:(0,i.jsx)(t.code,{children:"regex"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"regex"})," option is the regular expression to match and capture elements from the request URL."]}),"\n",(0,i.jsx)(t.p,{children:"!!! tip"}),"\n",(0,i.jsxs)(t.p,{children:["Regular expressions and replacements can be tested using online tools such as ",(0,i.jsx)(t.a,{href:"https://play.golang.org/p/mWU9p-wk2ru",children:"Go Playground"})," or the ",(0,i.jsx)(t.a,{href:"https://regex101.com/r/58sIgx/2",children:"Regex101"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["When defining a regular expression within YAML, any escaped character needs to be escaped twice: ",(0,i.jsx)(t.code,{children:"example\\.com"})," needs to be written as ",(0,i.jsx)(t.code,{children:"example\\\\.com"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"replacement",children:(0,i.jsx)(t.code,{children:"replacement"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"replacement"})," option defines how to modify the URL to have the new target URL."]}),"\n",(0,i.jsx)(t.p,{children:"!!! warning"}),"\n",(0,i.jsxs)(t.p,{children:["Care should be taken when defining replacement expand variables: ",(0,i.jsx)(t.code,{children:"$1x"})," is equivalent to ",(0,i.jsx)(t.code,{children:"${1x}"}),", not ",(0,i.jsx)(t.code,{children:"${1}x"})," (see ",(0,i.jsx)(t.a,{href:"https://golang.org/pkg/regexp/#Regexp.Expand",children:"Regexp.Expand"}),"), so use ",(0,i.jsx)(t.code,{children:"${1}"})," syntax."]})]})}function h(e={}){const{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);