"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[4280],{4480:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>l,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"operations/api","title":"Mesh API Documentation","description":"Mesh Proxy exposes information through API handlers. Learn about the security, configuration, and endpoints of APIs. Read the technical documentation.","source":"@site/docs/operations/api.md","sourceDirName":"operations","slug":"/operations/api","permalink":"/doc/docs/operations/api","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/operations/api.md","tags":[],"version":"current","frontMatter":{"title":"Mesh API Documentation","description":"Mesh Proxy exposes information through API handlers. Learn about the security, configuration, and endpoints of APIs. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh Tracing Overview","permalink":"/doc/docs/observability/tracing/overview"},"next":{"title":"Mesh CLI Documentation","permalink":"/doc/docs/operations/cli"}}');var r=t(4848),s=t(8453);const d={title:"Mesh API Documentation",description:"Mesh Proxy exposes information through API handlers. Learn about the security, configuration, and endpoints of APIs. Read the technical documentation."},a="API",o={},c=[{value:"Security",id:"security",level:2},{value:"Configuration",id:"configuration",level:2},{value:"<code>insecure</code>",id:"insecure",level:3},{value:"<code>dashboard</code>",id:"dashboard",level:3},{value:"<code>debug</code>",id:"debug",level:3},{value:"Endpoints",id:"endpoints",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"api",children:"API"})}),"\n",(0,r.jsx)(n.p,{children:"Mesh exposes a number of information through an API handler, such as the configuration of all routers, services, middlewares, etc."}),"\n",(0,r.jsxs)(n.p,{children:["As with all features of Mesh, this handler can be enabled with the ",(0,r.jsx)(n.a,{href:"/doc/docs/getting-started/configuration-overview#the-static-configuration",children:"static configuration"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,r.jsx)(n.p,{children:"Enabling the API in production is not recommended, because it will expose all configuration elements,\nincluding sensitive data."}),"\n",(0,r.jsx)(n.p,{children:"In production, it should be at least secured by authentication and authorizations."}),"\n",(0,r.jsxs)(n.p,{children:["!!! info\nIt's recommended to NOT publicly exposing the API's port, keeping it restricted to internal networks\n(as in the ",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Principle_of_least_privilege",children:"principle of least privilege"}),", applied to networks)."]}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(n.p,{children:["If you enable the API, a new special ",(0,r.jsx)(n.code,{children:"service"})," named ",(0,r.jsx)(n.code,{children:"api@internal"})," is created and can then be referenced in a router."]}),"\n",(0,r.jsxs)(n.p,{children:["To enable the API handler, use the following option on the\n",(0,r.jsx)(n.a,{href:"/doc/docs/getting-started/configuration-overview#the-static-configuration",children:"static configuration"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Static Configuration\napi: {}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"# Static Configuration\n[api]\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--api=true\n"})}),"\n",(0,r.jsxs)(n.p,{children:["And then define a routing configuration on Mesh itself with the\n",(0,r.jsx)(n.a,{href:"/doc/docs/getting-started/configuration-overview#the-dynamic-configuration",children:"dynamic configuration"}),":"]}),"\n",(0,r.jsxs)(n.p,{children:["??? warning \"The router's ",(0,r.jsx)(n.a,{href:"../../routing/routers#rule",children:"rule"})," must catch requests for the URI path ",(0,r.jsx)(n.code,{children:"/api"}),'"\nUsing an "Host" rule is recommended, by catching all the incoming traffic on this host domain to the API.\nHowever, you can also use "path prefix" rule or any combination or rules.']}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="Host Rule"',children:'# Matches http://Mesh.example.com, http://Mesh.example.com/api\n# or http://Mesh.example.com/hello\nrule = "Host(`Mesh.example.com`)"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="Path Prefix Rule"',children:'# Matches http://api.Mesh.example.com/api or http://example.com/api\n# but does not match http://api.Mesh.example.com/hello\nrule = "PathPrefix(`/api`)"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="Combination of Rules"',children:'# Matches http://Mesh.example.com/api or http://Mesh.example.com/dashboard\n# but does not match http://Mesh.example.com/hello\nrule = "Host(`Mesh.example.com`) && (PathPrefix(`/api`) || PathPrefix(`/dashboard`))"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"insecure",children:(0,r.jsx)(n.code,{children:"insecure"})}),"\n",(0,r.jsxs)(n.p,{children:["Enable the API in ",(0,r.jsx)(n.code,{children:"insecure"})," mode, which means that the API will be available directly on the entryPoint named ",(0,r.jsx)(n.code,{children:"Mesh"}),", on path ",(0,r.jsx)(n.code,{children:"/api"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["!!! info\nIf the entryPoint named ",(0,r.jsx)(n.code,{children:"Mesh"})," is not configured, it will be automatically created on port 8080."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"api:\n  insecure: true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[api]\n  insecure = true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--api.insecure=true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"dashboard",children:(0,r.jsx)(n.code,{children:"dashboard"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Optional, Default=true"})}),"\n",(0,r.jsxs)(n.p,{children:["Enable the dashboard. More about the dashboard features ",(0,r.jsx)(n.a,{href:"/doc/docs/operations/dashboard",children:"here"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"api:\n  dashboard: true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[api]\n  dashboard = true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--api.dashboard=true\n"})}),"\n",(0,r.jsxs)(n.p,{children:['!!! warning "With Dashboard enabled, the router ',(0,r.jsx)(n.a,{href:"../../routing/routers#rule",children:"rule"})," must catch requests for both ",(0,r.jsx)(n.code,{children:"/api"})," and ",(0,r.jsx)(n.code,{children:"/dashboard"}),'"\nPlease check the ',(0,r.jsx)(n.a,{href:"/doc/docs/operations/dashboard#dashboard-router-rule",children:"Dashboard documentation"})," to learn more about this and to get examples."]}),"\n",(0,r.jsx)(n.h3,{id:"debug",children:(0,r.jsx)(n.code,{children:"debug"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.em,{children:"Optional, Default=false"})}),"\n",(0,r.jsxs)(n.p,{children:["Enable additional ",(0,r.jsx)(n.a,{href:"/doc/docs/operations/api#endpoints",children:"endpoints"})," for debugging and profiling, served under ",(0,r.jsx)(n.code,{children:"/debug/"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"api:\n  debug: true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[api]\n  debug = true\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--api.debug=true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,r.jsxs)(n.p,{children:["All the following endpoints must be accessed with a ",(0,r.jsx)(n.code,{children:"GET"})," HTTP request."]}),"\n",(0,r.jsx)(n.p,{children:'!!! info "Pagination"'}),"\n",(0,r.jsxs)(n.p,{children:["By default, up to 100 results are returned per page, and the next page can be checked using the ",(0,r.jsx)(n.code,{children:"X-Next-Page"})," HTTP Header.\nTo control pagination, use the ",(0,r.jsx)(n.code,{children:"page"})," and ",(0,r.jsx)(n.code,{children:"per_page"})," query parameters."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl https://Mesh.example.com:8080/api/http/routers?page=2&per_page=20\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Path"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/routers"})}),(0,r.jsx)(n.td,{children:"Lists all the HTTP routers information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/routers/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the HTTP router specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/services"})}),(0,r.jsx)(n.td,{children:"Lists all the HTTP services information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/services/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the HTTP service specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/middlewares"})}),(0,r.jsx)(n.td,{children:"Lists all the HTTP middlewares information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/http/middlewares/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the HTTP middleware specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/routers"})}),(0,r.jsx)(n.td,{children:"Lists all the TCP routers information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/routers/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the TCP router specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/services"})}),(0,r.jsx)(n.td,{children:"Lists all the TCP services information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/services/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the TCP service specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/middlewares"})}),(0,r.jsx)(n.td,{children:"Lists all the TCP middlewares information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/tcp/middlewares/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the TCP middleware specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/udp/routers"})}),(0,r.jsx)(n.td,{children:"Lists all the UDP routers information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/udp/routers/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the UDP router specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/udp/services"})}),(0,r.jsx)(n.td,{children:"Lists all the UDP services information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/udp/services/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the UDP service specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/entrypoints"})}),(0,r.jsx)(n.td,{children:"Lists all the entry points information."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/entrypoints/{name}"})}),(0,r.jsxs)(n.td,{children:["Returns the information of the entry point specified by ",(0,r.jsx)(n.code,{children:"name"}),"."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/overview"})}),(0,r.jsx)(n.td,{children:"Returns statistic information about http and tcp as well as enabled features and providers."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/support-dump"})}),(0,r.jsx)(n.td,{children:"Returns an archive that contains the anonymized static configuration and the runtime configuration."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/rawdata"})}),(0,r.jsx)(n.td,{children:"Returns information about dynamic configurations, errors, status and dependency relations."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/api/version"})}),(0,r.jsx)(n.td,{children:"Returns information about Mesh version."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/vars"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/expvar/",children:"expvar"})," Go documentation."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/pprof/"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/net/http/pprof/#Index",children:"pprof Index"})," Go documentation."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/pprof/cmdline"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/net/http/pprof/#Cmdline",children:"pprof Cmdline"})," Go documentation."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/pprof/profile"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/net/http/pprof/#Profile",children:"pprof Profile"})," Go documentation."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/pprof/symbol"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/net/http/pprof/#Symbol",children:"pprof Symbol"})," Go documentation."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"/debug/pprof/trace"})}),(0,r.jsxs)(n.td,{children:["See the ",(0,r.jsx)(n.a,{href:"https://golang.org/pkg/net/http/pprof/#Trace",children:"pprof Trace"})," Go documentation."]})]})]})]})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>a});var i=t(6540);const r={},s=i.createContext(r);function d(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);