"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[4976],{5881:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"https/tls","title":"Mesh TLS Documentation","description":"Learn how to configure the transport layer security (TLS) connection in Mesh Proxy. Read the technical documentation.","source":"@site/docs/https/tls.md","sourceDirName":"https","slug":"/https/tls","permalink":"/doc/docs/https/tls","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/https/tls.md","tags":[],"version":"current","frontMatter":{"title":"Mesh TLS Documentation","description":"Learn how to configure the transport layer security (TLS) connection in Mesh Proxy. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh Tailscale Documentation","permalink":"/doc/docs/https/tailscale"},"next":{"title":"kubernetes-requirements","permalink":"/doc/docs/includes/kubernetes-requirements"}}');var s=t(4848),a=t(8453);const r={title:"Mesh TLS Documentation",description:"Learn how to configure the transport layer security (TLS) connection in Mesh Proxy. Read the technical documentation."},o="TLS",l={},c=[{value:"Certificates Definition",id:"certificates-definition",level:2},{value:"Automated",id:"automated",level:3},{value:"User defined",id:"user-defined",level:3},{value:"Certificates Stores",id:"certificates-stores",level:2},{value:"Default Certificate",id:"default-certificate",level:3},{value:"ACME Default Certificate",id:"acme-default-certificate",level:3},{value:"TLS Options",id:"tls-options",level:2},{value:"Minimum TLS Version",id:"minimum-tls-version",level:3},{value:"Maximum TLS Version",id:"maximum-tls-version",level:3},{value:"Cipher Suites",id:"cipher-suites",level:3},{value:"Curve Preferences",id:"curve-preferences",level:3},{value:"Strict SNI Checking",id:"strict-sni-checking",level:3},{value:"ALPN Protocols",id:"alpn-protocols",level:3},{value:"Client Authentication (mTLS)",id:"client-authentication-mtls",level:3},{value:"Disable Session Tickets",id:"disable-session-tickets",level:3}];function d(e){const n={a:"a",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"tls",children:"TLS"})}),"\n",(0,s.jsx)(n.p,{children:"Transport Layer Security"}),"\n",(0,s.jsx)(n.h2,{id:"certificates-definition",children:"Certificates Definition"}),"\n",(0,s.jsx)(n.h3,{id:"automated",children:"Automated"}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/doc/docs/https/acme",children:"Let's Encrypt"})," page."]}),"\n",(0,s.jsx)(n.h3,{id:"user-defined",children:"User defined"}),"\n",(0,s.jsxs)(n.p,{children:["To add / remove TLS certificates, even when Mesh is already running, their definition can be added to the ",(0,s.jsx)(n.a,{href:"/doc/docs/getting-started/configuration-overview",children:"dynamic configuration"}),", in the ",(0,s.jsx)(n.code,{children:"[[tls.certificates]]"})," section:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  certificates:\n    - certFile: /path/to/domain.cert\n      keyFile: /path/to/domain.key\n    - certFile: /path/to/other-domain.cert\n      keyFile: /path/to/other-domain.key\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[[tls.certificates]]\n  certFile = "/path/to/domain.cert"\n  keyFile = "/path/to/domain.key"\n\n[[tls.certificates]]\n  certFile = "/path/to/other-domain.cert"\n  keyFile = "/path/to/other-domain.key"\n'})}),"\n",(0,s.jsx)(n.p,{children:'!!! important "Restriction"'}),"\n",(0,s.jsxs)(n.p,{children:["In the above example, we've used the ",(0,s.jsx)(n.a,{href:"/doc/docs/providers/file",children:"file provider"})," to handle these definitions.\nIt is the only available method to configure the certificates (as well as the options and the stores).\nHowever, in ",(0,s.jsx)(n.a,{href:"/doc/docs/providers/kubernetes-crd",children:"Kubernetes"}),", the certificates can and must be provided by ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/configuration/secret/",children:"secrets"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"certificates-stores",children:"Certificates Stores"}),"\n",(0,s.jsx)(n.p,{children:"In Mesh, certificates are grouped together in certificates stores, which are defined as such:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  stores:\n    default: {}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"# Dynamic configuration\n\n[tls.stores]\n  [tls.stores.default]\n"})}),"\n",(0,s.jsx)(n.p,{children:'!!! important "Restriction"'}),"\n",(0,s.jsxs)(n.p,{children:["Any store definition other than the default one (named ",(0,s.jsx)(n.code,{children:"default"}),") will be ignored,\nand there is therefore only one globally available TLS store."]}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"tls.certificates"})," section, a list of stores can then be specified to indicate where the certificates should be stored:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  certificates:\n    - certFile: /path/to/domain.cert\n      keyFile: /path/to/domain.key\n      stores:\n        - default\n    # Note that since no store is defined,\n    # the certificate below will be stored in the `default` store.\n    - certFile: /path/to/other-domain.cert\n      keyFile: /path/to/other-domain.key\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[[tls.certificates]]\n  certFile = "/path/to/domain.cert"\n  keyFile = "/path/to/domain.key"\n  stores = ["default"]\n\n[[tls.certificates]]\n  # Note that since no store is defined,\n  # the certificate below will be stored in the `default` store.\n  certFile = "/path/to/other-domain.cert"\n  keyFile = "/path/to/other-domain.key"\n'})}),"\n",(0,s.jsx)(n.p,{children:'!!! important "Restriction"'}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"stores"})," list will actually be ignored and automatically set to ",(0,s.jsx)(n.code,{children:'["default"]'}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"default-certificate",children:"Default Certificate"}),"\n",(0,s.jsx)(n.p,{children:"Mesh can use a default certificate for connections without a SNI, or without a matching domain.\nThis default certificate should be defined in a TLS store:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  stores:\n    default:\n      defaultCertificate:\n        certFile: path/to/cert.crt\n        keyFile: path/to/cert.key\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.stores]\n  [tls.stores.default]\n    [tls.stores.default.defaultCertificate]\n      certFile = "path/to/cert.crt"\n      keyFile  = "path/to/cert.key"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSStore\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  defaultCertificate:\n    secretName: default-certificate\n    \n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: default-certificate\n  namespace: default\n  \ntype: Opaque\ndata:\n  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0=\n  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0=\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If no ",(0,s.jsx)(n.code,{children:"defaultCertificate"})," is provided, Mesh will use the generated one."]}),"\n",(0,s.jsx)(n.h3,{id:"acme-default-certificate",children:"ACME Default Certificate"}),"\n",(0,s.jsx)(n.p,{children:"You can configure Mesh to use an ACME provider (like Let's Encrypt) to generate the default certificate.\nThe configuration to resolve the default certificate should be defined in a TLS store:"}),"\n",(0,s.jsxs)(n.p,{children:['!!! important "Precedence with the ',(0,s.jsx)(n.code,{children:"defaultGeneratedCert"}),' option"']}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"defaultGeneratedCert"})," definition takes precedence over the ACME default certificate configuration."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  stores:\n    default:\n      defaultGeneratedCert:\n        resolver: myresolver\n        domain:\n          main: example.org\n          sans:\n            - foo.example.org\n            - bar.example.org\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.stores]\n  [tls.stores.default.defaultGeneratedCert]\n    resolver = "myresolver"\n    [tls.stores.default.defaultGeneratedCert.domain]\n      main = "example.org"\n      sans = ["foo.example.org", "bar.example.org"]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSStore\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  defaultGeneratedCert:\n    resolver: myresolver\n    domain:\n      main: example.org\n      sans:\n        - foo.example.org\n        - bar.example.org\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'## Dynamic configuration\nlabels:\n  - "Mesh.tls.stores.default.defaultgeneratedcert.resolver=myresolver"\n  - "Mesh.tls.stores.default.defaultgeneratedcert.domain.main=example.org"\n  - "Mesh.tls.stores.default.defaultgeneratedcert.domain.sans=foo.example.org, bar.example.org"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"tls-options",children:"TLS Options"}),"\n",(0,s.jsx)(n.p,{children:"The TLS options allow one to configure some parameters of the TLS connection."}),"\n",(0,s.jsx)(n.p,{children:"!!! important \"'default' TLS Option\""}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"default"})," option is special.\nWhen no tls options are specified in a tls router, the ",(0,s.jsx)(n.code,{children:"default"})," option is used.",(0,s.jsx)(n.br,{}),"\n","When specifying the ",(0,s.jsx)(n.code,{children:"default"})," option explicitly, make sure not to specify provider namespace as the ",(0,s.jsx)(n.code,{children:"default"})," option does not have one.",(0,s.jsx)(n.br,{}),"\n","Conversely, for cross-provider references, for example, when referencing the file provider from a docker label,\nyou must specify the provider namespace, for example:",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.code,{children:"Mesh.http.routers.myrouter.tls.options=myoptions@file"})]}),"\n",(0,s.jsx)(n.p,{children:'!!! important "TLSOption in Kubernetes"'}),"\n",(0,s.jsxs)(n.p,{children:["When using the ",(0,s.jsx)(n.a,{href:"../../routing/providers/kubernetes-crd#kind-tlsoption",children:"TLSOption resource"})," in Kubernetes, one might setup a default set of options that,\nif not explicitly overwritten, should apply to all ingresses.",(0,s.jsx)(n.br,{}),"\n","To achieve that, you'll have to create a TLSOption resource with the name ",(0,s.jsx)(n.code,{children:"default"}),".\nThere may exist only one TLSOption with the name ",(0,s.jsx)(n.code,{children:"default"})," (across all namespaces) - otherwise they will be dropped.",(0,s.jsx)(n.br,{}),"\n","To explicitly use a different TLSOption (and using the Kubernetes Ingress resources)\nyou'll have to add an annotation to the Ingress in the following form:\n",(0,s.jsx)(n.code,{children:"Mesh.ingress.kubernetes.io/router.tls.options: <resource-namespace>-<resource-name>@kubernetescrd"})]}),"\n",(0,s.jsx)(n.h3,{id:"minimum-tls-version",children:"Minimum TLS Version"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      minVersion: VersionTLS12\n\n    mintls13:\n      minVersion: VersionTLS13\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n\n  [tls.options.default]\n    minVersion = "VersionTLS12"\n\n  [tls.options.mintls13]\n    minVersion = "VersionTLS13"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  minVersion: VersionTLS12\n\n---\napiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: mintls13\n  namespace: default\n\nspec:\n  minVersion: VersionTLS13\n"})}),"\n",(0,s.jsx)(n.h3,{id:"maximum-tls-version",children:"Maximum TLS Version"}),"\n",(0,s.jsx)(n.p,{children:"We discourage the use of this setting to disable TLS1.3."}),"\n",(0,s.jsx)(n.p,{children:"The recommended approach is to update the clients to support TLS1.3."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      maxVersion: VersionTLS13\n\n    maxtls12:\n      maxVersion: VersionTLS12\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n\n  [tls.options.default]\n    maxVersion = "VersionTLS13"\n\n  [tls.options.maxtls12]\n    maxVersion = "VersionTLS12"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  maxVersion: VersionTLS13\n\n---\napiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: maxtls12\n  namespace: default\n\nspec:\n  maxVersion: VersionTLS12\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cipher-suites",children:"Cipher Suites"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://godoc.org/crypto/tls#pkg-constants",children:"cipherSuites"})," for more information."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      cipherSuites:\n        - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    cipherSuites = [\n      "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"\n    ]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  cipherSuites:\n    - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\n"})}),"\n",(0,s.jsx)(n.p,{children:'!!! important "TLS 1.3"'}),"\n",(0,s.jsxs)(n.p,{children:["Cipher suites defined for TLS 1.2 and below cannot be used in TLS 1.3, and vice versa. ",(0,s.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc8446"}),(0,s.jsx)(n.br,{}),"\n","With TLS 1.3, the cipher suites are not configurable (all supported cipher suites are safe in this case).\n",(0,s.jsx)(n.a,{href:"https://golang.org/doc/go1.12#tls_1_3"})]}),"\n",(0,s.jsx)(n.h3,{id:"curve-preferences",children:"Curve Preferences"}),"\n",(0,s.jsx)(n.p,{children:"This option allows to set the preferred elliptic curves in a specific order."}),"\n",(0,s.jsxs)(n.p,{children:["The names of the curves defined by ",(0,s.jsx)(n.a,{href:"https://godoc.org/crypto/tls#CurveID",children:(0,s.jsx)(n.code,{children:"crypto"})})," (e.g. ",(0,s.jsx)(n.code,{children:"CurveP521"}),") and the ",(0,s.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc8446#section-4.2.7",children:"RFC defined names"})," (e. g. ",(0,s.jsx)(n.code,{children:"secp521r1"}),") can be used."]}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"https://godoc.org/crypto/tls#CurveID",children:"CurveID"})," for more information."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      curvePreferences:\n        - CurveP521\n        - CurveP384\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    curvePreferences = ["CurveP521", "CurveP384"]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  curvePreferences:\n    - CurveP521\n    - CurveP384\n"})}),"\n",(0,s.jsx)(n.h3,{id:"strict-sni-checking",children:"Strict SNI Checking"}),"\n",(0,s.jsx)(n.p,{children:"With strict SNI checking enabled, Mesh won't allow connections from clients that do not specify a server_name extension\nor don't match any of the configured certificates.\nThe default certificate is irrelevant on that matter."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      sniStrict: true\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    sniStrict = true\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  sniStrict: true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"alpn-protocols",children:"ALPN Protocols"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:'Optional, Default="h2, http/1.1, acme-tls/1"'})}),"\n",(0,s.jsx)(n.p,{children:"This option allows to specify the list of supported application level protocols for the TLS handshake,\nin order of preference.\nIf the client supports ALPN, the selected protocol will be one from this list,\nand the connection will fail if there is no mutually supported protocol."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      alpnProtocols:\n        - http/1.1\n        - h2\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    alpnProtocols = ["http/1.1", "h2"]\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  alpnProtocols:\n    - http/1.1\n    - h2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"client-authentication-mtls",children:"Client Authentication (mTLS)"}),"\n",(0,s.jsxs)(n.p,{children:["Mesh supports mutual authentication, through the ",(0,s.jsx)(n.code,{children:"clientAuth"})," section."]}),"\n",(0,s.jsxs)(n.p,{children:["For authentication policies that require verification of the client certificate, the certificate authority for the certificates should be set in ",(0,s.jsx)(n.code,{children:"clientAuth.caFiles"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["In Kubernetes environment, CA certificate can be set in ",(0,s.jsx)(n.code,{children:"clientAuth.secretNames"}),". See ",(0,s.jsx)(n.a,{href:"../../routing/providers/kubernetes-crd#kind-tlsoption",children:"TLSOption resource"})," for more details."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"clientAuth.clientAuthType"})," option governs the behaviour as follows:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"NoClientCert"}),": disregards any client certificate."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequestClientCert"}),": asks for a certificate but proceeds anyway if none is provided."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequireAnyClientCert"}),": requires a certificate but does not verify if it is signed by a CA listed in ",(0,s.jsx)(n.code,{children:"clientAuth.caFiles"})," or in ",(0,s.jsx)(n.code,{children:"clientAuth.secretNames"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"VerifyClientCertIfGiven"}),": if a certificate is provided, verifies if it is signed by a CA listed in ",(0,s.jsx)(n.code,{children:"clientAuth.caFiles"})," or in ",(0,s.jsx)(n.code,{children:"clientAuth.secretNames"}),". Otherwise proceeds without any certificate."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"RequireAndVerifyClientCert"}),": requires a certificate, which must be signed by a CA listed in ",(0,s.jsx)(n.code,{children:"clientAuth.caFiles"})," or in ",(0,s.jsx)(n.code,{children:"clientAuth.secretNames"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      clientAuth:\n        # in PEM format. each file can contain multiple CAs.\n        caFiles:\n          - tests/clientca1.crt\n          - tests/clientca2.crt\n        clientAuthType: RequireAndVerifyClientCert\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    [tls.options.default.clientAuth]\n      # in PEM format. each file can contain multiple CAs.\n      caFiles = ["tests/clientca1.crt", "tests/clientca2.crt"]\n      clientAuthType = "RequireAndVerifyClientCert"\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  clientAuth:\n    # the CA certificate is extracted from key `tls.ca` or `ca.crt` of the given secrets.\n    secretNames:\n      - secretCA\n    clientAuthType: RequireAndVerifyClientCert\n"})}),"\n",(0,s.jsx)(n.h3,{id:"disable-session-tickets",children:"Disable Session Tickets"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:'Optional, Default="false"'})}),"\n",(0,s.jsx)(n.p,{children:"When set to true, Mesh disables the use of session tickets, forcing every client to perform a full TLS handshake instead of resuming sessions."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"# Dynamic configuration\n\ntls:\n  options:\n    default:\n      disableSessionTickets: true\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"# Dynamic configuration\n\n[tls.options]\n  [tls.options.default]\n    disableSessionTickets = true\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: TLSOption\nmetadata:\n  name: default\n  namespace: default\n\nspec:\n  disableSessionTickets: true\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);