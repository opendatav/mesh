"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[7241],{8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const t={},i=r.createContext(t);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},8730:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"providers/kubernetes-ingress","title":"Mesh Kubernetes Ingress Documentation","description":"Understand the requirements, routing configuration, and how to set up Mesh Proxy as your Kubernetes Ingress Controller. Read the technical documentation.","source":"@site/docs/providers/kubernetes-ingress.md","sourceDirName":"providers","slug":"/providers/kubernetes-ingress","permalink":"/doc/docs/providers/kubernetes-ingress","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/providers/kubernetes-ingress.md","tags":[],"version":"current","frontMatter":{"title":"Mesh Kubernetes Ingress Documentation","description":"Understand the requirements, routing configuration, and how to set up Mesh Proxy as your Kubernetes Ingress Controller. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh Kubernetes Gateway API Documentation","permalink":"/doc/docs/providers/kubernetes-gateway"},"next":{"title":"Nomad Service Discovery","permalink":"/doc/docs/providers/nomad"}}');var t=s(4848),i=s(8453);const a={title:"Mesh Kubernetes Ingress Documentation",description:"Understand the requirements, routing configuration, and how to set up Mesh Proxy as your Kubernetes Ingress Controller. Read the technical documentation."},l="Mesh & Kubernetes",o={},c=[{value:"Requirements",id:"requirements",level:2},{value:"Routing Configuration",id:"routing-configuration",level:2},{value:"Enabling and Using the Provider",id:"enabling-and-using-the-provider",level:2},{value:"LetsEncrypt Support with the Ingress Provider",id:"letsencrypt-support-with-the-ingress-provider",level:2},{value:"Provider Configuration",id:"provider-configuration",level:2},{value:"<code>endpoint</code>",id:"endpoint",level:3},{value:"<code>token</code>",id:"token",level:3},{value:"<code>certAuthFilePath</code>",id:"certauthfilepath",level:3},{value:"<code>namespaces</code>",id:"namespaces",level:3},{value:"<code>labelSelector</code>",id:"labelselector",level:3},{value:"<code>ingressClass</code>",id:"ingressclass",level:3},{value:"<code>disableIngressClassLookup</code>",id:"disableingressclasslookup",level:3},{value:"<code>disableClusterScopeResources</code>",id:"disableclusterscoperesources",level:3},{value:"<code>ingressEndpoint</code>",id:"ingressendpoint",level:3},{value:"<code>hostname</code>",id:"hostname",level:4},{value:"<code>ip</code>",id:"ip",level:4},{value:"<code>publishedService</code>",id:"publishedservice",level:4},{value:"<code>throttleDuration</code>",id:"throttleduration",level:3},{value:"<code>allowEmptyServices</code>",id:"allowemptyservices",level:3},{value:"<code>allowExternalNameServices</code>",id:"allowexternalnameservices",level:3},{value:"<code>nativeLBByDefault</code>",id:"nativelbbydefault",level:3},{value:"Further",id:"further",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mesh--kubernetes",children:"Mesh & Kubernetes"})}),"\n",(0,t.jsx)(n.p,{children:"The Kubernetes Ingress Controller."}),"\n",(0,t.jsxs)(n.p,{children:["The Mesh Kubernetes Ingress provider is a Kubernetes Ingress controller; that is to say,\nit manages access to cluster services by supporting the ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/ingress/",children:"Ingress"})," specification."]}),"\n",(0,t.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsx)(n.h2,{id:"routing-configuration",children:"Routing Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["See the dedicated section in ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/providers/kubernetes-ingress",children:"routing"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"enabling-and-using-the-provider",children:"Enabling and Using the Provider"}),"\n",(0,t.jsx)(n.p,{children:"You can enable the provider in the static configuration:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress: {}\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress=true\n"})}),"\n",(0,t.jsx)(n.p,{children:"The provider then watches for incoming ingresses events, such as the example below,\nand derives the corresponding dynamic configuration from it,\nwhich in turn creates the resulting routers, services, handlers, etc."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="Ingress"',children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: foo\n  namespace: production\n\nspec:\n  rules:\n    - host: example.net\n      http:\n        paths:\n          - path: /bar\n            pathType: Exact\n            backend:\n              service:\n                name:  service1\n                port:\n                  number: 80\n          - path: /foo\n            pathType: Exact\n            backend:\n              service:\n                name:  service1\n                port:\n                  number: 80\n"})}),"\n",(0,t.jsx)(n.h2,{id:"letsencrypt-support-with-the-ingress-provider",children:"LetsEncrypt Support with the Ingress Provider"}),"\n",(0,t.jsx)(n.p,{children:"By design, Mesh is a stateless application,\nmeaning that it only derives its configuration from the environment it runs in,\nwithout additional configuration.\nFor this reason, users can run multiple instances of Mesh at the same time to achieve HA,\nas is a common pattern in the kubernetes ecosystem."}),"\n",(0,t.jsxs)(n.p,{children:["When using a single instance of Mesh Proxy with Let's Encrypt, you should encounter no issues.\nHowever, this could be a single point of failure.\nUnfortunately, it is not possible to run multiple instances of Mesh 2.0 with Let's Encrypt enabled,\nbecause there is no way to ensure that the correct instance of Mesh receives the challenge request, and subsequent responses.\nEarly versions (v1.x) of Mesh used a ",(0,t.jsx)(n.a,{href:"https://doc.Mesh.io/Mesh/v1.7/configuration/acme/#storage",children:"KV store"})," to attempt to achieve this,\nbut due to sub-optimal performance that feature was dropped in 2.0."]}),"\n",(0,t.jsxs)(n.p,{children:["If you need Let's Encrypt with high availability in a Kubernetes environment,\nwe recommend using ",(0,t.jsx)(n.a,{href:"https://Mesh.io/mesh-enterprise/",children:"Mesh Enterprise"})," which includes distributed Let's Encrypt as a supported feature."]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to keep using Mesh Proxy,\nLetsEncrypt HA can be achieved by using a Certificate Controller such as ",(0,t.jsx)(n.a,{href:"https://cert-manager.io/docs/",children:"Cert-Manager"}),".\nWhen using Cert-Manager to manage certificates,\nit creates secrets in your namespaces that can be referenced as TLS secrets in your ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/ingress/#tls",children:"ingress objects"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"provider-configuration",children:"Provider Configuration"}),"\n",(0,t.jsx)(n.h3,{id:"endpoint",children:(0,t.jsx)(n.code,{children:"endpoint"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"The Kubernetes server endpoint URL."}),"\n",(0,t.jsxs)(n.p,{children:["When deployed into Kubernetes, Mesh reads the environment variables ",(0,t.jsx)(n.code,{children:"KUBERNETES_SERVICE_HOST"})," and ",(0,t.jsx)(n.code,{children:"KUBERNETES_SERVICE_PORT"})," or ",(0,t.jsx)(n.code,{children:"KUBECONFIG"})," to construct the endpoint."]}),"\n",(0,t.jsxs)(n.p,{children:["The access token is looked up in ",(0,t.jsx)(n.code,{children:"/var/run/secrets/kubernetes.io/serviceaccount/token"})," and the SSL CA certificate in ",(0,t.jsx)(n.code,{children:"/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"}),".\nBoth are mounted automatically when deployed inside Kubernetes."]}),"\n",(0,t.jsx)(n.p,{children:"The endpoint may be specified to override the environment variable values inside a cluster."}),"\n",(0,t.jsxs)(n.p,{children:["When the environment variables are not found, Mesh tries to connect to the Kubernetes API server with an external-cluster client.\nIn this case, the endpoint is required.\nSpecifically, it may be set to the URL used by ",(0,t.jsx)(n.code,{children:"kubectl proxy"})," to connect to a Kubernetes cluster using the granted authentication and authorization of the associated kubeconfig."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    endpoint: "http://localhost:8080"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  endpoint = "http://localhost:8080"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.endpoint=http://localhost:8080\n"})}),"\n",(0,t.jsx)(n.h3,{id:"token",children:(0,t.jsx)(n.code,{children:"token"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"Bearer token used for the Kubernetes client configuration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    token: "mytoken"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  token = "mytoken"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.token=mytoken\n"})}),"\n",(0,t.jsx)(n.h3,{id:"certauthfilepath",children:(0,t.jsx)(n.code,{children:"certAuthFilePath"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default=""'})}),"\n",(0,t.jsx)(n.p,{children:"Path to the certificate authority file.\nUsed for the Kubernetes client configuration."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    certAuthFilePath: "/my/ca.crt"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  certAuthFilePath = "/my/ca.crt"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.certauthfilepath=/my/ca.crt\n"})}),"\n",(0,t.jsx)(n.h3,{id:"namespaces",children:(0,t.jsx)(n.code,{children:"namespaces"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: []"})}),"\n",(0,t.jsx)(n.p,{children:"Array of namespaces to watch.\nIf left empty, Mesh watches all namespaces."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    namespaces:\n      - "default"\n      - "production"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  namespaces = ["default", "production"]\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.namespaces=default,production\n"})}),"\n",(0,t.jsx)(n.h3,{id:"labelselector",children:(0,t.jsx)(n.code,{children:"labelSelector"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsx)(n.p,{children:"A label selector can be defined to filter on specific Ingress objects only.\nIf left empty, Mesh processes all Ingress objects in the configured namespaces."}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors",children:"label-selectors"})," for details."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    labelSelector: "app=Mesh"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  labelSelector = "app=Mesh"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:'--providers.kubernetesingress.labelselector="app=Mesh"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"ingressclass",children:(0,t.jsx)(n.code,{children:"ingressClass"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsxs)(n.p,{children:["Value of ",(0,t.jsx)(n.code,{children:"kubernetes.io/ingress.class"})," annotation that identifies Ingress objects to be processed."]}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set, only Ingresses containing an annotation with the same value are processed.\nOtherwise, Ingresses missing the annotation, having an empty value, or the value ",(0,t.jsx)(n.code,{children:"Mesh"})," are processed."]}),"\n",(0,t.jsx)(n.p,{children:'??? info "Example"'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="IngressClass"',children:"apiVersion: networking.k8s.io/v1\nkind: IngressClass\nmetadata:\n  name: mesh-lb\nspec:\n  controller: Mesh.io/ingress-controller\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="Ingress"',children:'apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: example-ingress\nspec:\n  ingressClassName: mesh-lb\n  rules:\n  - host: "*.example.com"\n    http:\n      paths:\n      - path: /example\n        pathType: Exact\n        backend:\n          service:\n            name: example-service\n            port:\n                number: 80\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    ingressClass: "mesh-internal"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  ingressClass = "mesh-internal"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.ingressclass=mesh-internal\n"})}),"\n",(0,t.jsx)(n.h3,{id:"disableingressclasslookup",children:(0,t.jsx)(n.code,{children:"disableIngressClassLookup"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsx)(n.p,{children:'??? warning "Deprecated"'}),"\n",(0,t.jsxs)(n.p,{children:["The Kubernetes Ingress provider option ",(0,t.jsx)(n.code,{children:"disableIngressClassLookup"})," has been deprecated in v3.1, and will be removed in the next major version.\nPlease use the ",(0,t.jsx)(n.code,{children:"disableClusterScopeResources"})," option instead."]}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nMesh will not discover IngressClasses in the cluster.\nBy doing so, it alleviates the requirement of giving Mesh the rights to look IngressClasses up.\nFurthermore, when this option is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nMesh is not able to handle Ingresses with IngressClass references,\ntherefore such Ingresses will be ignored.\nPlease note that annotations are not affected by this option."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress:\n    disableIngressClassLookup: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n  disableIngressClassLookup = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.disableingressclasslookup=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"disableclusterscoperesources",children:(0,t.jsx)(n.code,{children:"disableClusterScopeResources"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["When this parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nMesh will not discover cluster scope resources (",(0,t.jsx)(n.code,{children:"IngressClass"})," and ",(0,t.jsx)(n.code,{children:"Nodes"}),").\nBy doing so, it alleviates the requirement of giving Mesh the rights to look up for cluster resources.\nFurthermore, Mesh will not handle Ingresses with IngressClass references, therefore such Ingresses will be ignored (please note that annotations are not affected by this option).\nThis will also prevent from using the ",(0,t.jsx)(n.code,{children:"NodePortLB"})," options on services."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress:\n    disableClusterScopeResources: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n  disableClusterScopeResources = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.disableClusterScopeResources=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"ingressendpoint",children:(0,t.jsx)(n.code,{children:"ingressEndpoint"})}),"\n",(0,t.jsx)(n.h4,{id:"hostname",children:(0,t.jsx)(n.code,{children:"hostname"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsx)(n.p,{children:"Hostname used for Kubernetes Ingress endpoints."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    ingressEndpoint:\n      hostname: "example.net"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress.ingressEndpoint]\n  hostname = "example.net"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.ingressendpoint.hostname=example.net\n"})}),"\n",(0,t.jsx)(n.h4,{id:"ip",children:(0,t.jsx)(n.code,{children:"ip"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsxs)(n.p,{children:["This IP will get copied to Ingress ",(0,t.jsx)(n.code,{children:"status.loadbalancer.ip"}),", and currently only supports one IP value (IPv4 or IPv6)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    ingressEndpoint:\n      ip: "1.2.3.4"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress.ingressEndpoint]\n  ip = "1.2.3.4"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.ingressendpoint.ip=1.2.3.4\n"})}),"\n",(0,t.jsx)(n.h4,{id:"publishedservice",children:(0,t.jsx)(n.code,{children:"publishedService"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Optional, Default: ""'})}),"\n",(0,t.jsxs)(n.p,{children:["Format: ",(0,t.jsx)(n.code,{children:"namespace/servicename"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The Kubernetes service to copy status from,\ndepending on the service type:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ClusterIP:"})," The ExternalIPs of the service will be propagated to the ingress status."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"NodePort:"})," The ExternalIP addresses of the nodes in the cluster will be propagated to the ingress status."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"LoadBalancer:"})," The IPs from the service's ",(0,t.jsx)(n.code,{children:"loadBalancer.status"})," field (which contains the endpoints provided by the load balancer) will be propagated to the ingress status."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"When using third-party tools such as External-DNS, this option enables the copying of external service IPs to the ingress resources."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    ingressEndpoint:\n      publishedService: "namespace/foo-service"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress.ingressEndpoint]\n  publishedService = "namespace/foo-service"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.ingressendpoint.publishedservice=namespace/foo-service\n"})}),"\n",(0,t.jsx)(n.h3,{id:"throttleduration",children:(0,t.jsx)(n.code,{children:"throttleDuration"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: 0"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"throttleDuration"})," option defines how often the provider is allowed to handle events from Kubernetes. This prevents\na Kubernetes cluster that updates many times per second from continuously changing your Mesh configuration."]}),"\n",(0,t.jsx)(n.p,{children:"If left empty, the provider does not apply any throttling and does not drop any Kubernetes events."}),"\n",(0,t.jsxs)(n.p,{children:["The value of ",(0,t.jsx)(n.code,{children:"throttleDuration"})," should be provided in seconds or as a valid duration format,\nsee ",(0,t.jsx)(n.a,{href:"https://golang.org/pkg/time/#ParseDuration",children:"time.ParseDuration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'providers:\n  kubernetesIngress:\n    throttleDuration: "10s"\n    # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[providers.kubernetesIngress]\n  throttleDuration = "10s"\n  # ...\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.throttleDuration=10s\n"})}),"\n",(0,t.jsx)(n.h3,{id:"allowemptyservices",children:(0,t.jsx)(n.code,{children:"allowEmptyServices"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nit allows the creation of an empty ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/services/#servers-load-balancer",children:"servers load balancer"})," if the targeted Kubernetes service has no endpoints available.\nThis results in ",(0,t.jsx)(n.code,{children:"503"})," HTTP responses instead of ",(0,t.jsx)(n.code,{children:"404"})," ones."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress:\n    allowEmptyServices: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n  allowEmptyServices = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.allowEmptyServices=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"allowexternalnameservices",children:(0,t.jsx)(n.code,{children:"allowExternalNameServices"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["If the parameter is set to ",(0,t.jsx)(n.code,{children:"true"}),",\nIngresses are able to reference ExternalName services."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress:\n    allowExternalNameServices: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n  allowExternalNameServices = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.allowexternalnameservices=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"nativelbbydefault",children:(0,t.jsx)(n.code,{children:"nativeLBByDefault"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:"Optional, Default: false"})}),"\n",(0,t.jsxs)(n.p,{children:["Defines whether to use Native Kubernetes load-balancing mode by default.\nFor more information, please check out the ",(0,t.jsx)(n.code,{children:"Mesh.ingress.kubernetes.io/service.nativelb"})," ",(0,t.jsx)(n.a,{href:"/doc/docs/routing/providers/kubernetes-ingress#on-service",children:"service annotation documentation"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"providers:\n  kubernetesIngress:\n    nativeLBByDefault: true\n    # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[providers.kubernetesIngress]\n  nativeLBByDefault = true\n  # ...\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'tab="CLI"',children:"--providers.kubernetesingress.nativeLBByDefault=true\n"})}),"\n",(0,t.jsx)(n.h3,{id:"further",children:"Further"}),"\n",(0,t.jsxs)(n.p,{children:["To learn more about the various aspects of the Ingress specification that Mesh supports,\nmany examples of Ingresses definitions are located in the test ",(0,t.jsx)(n.a,{href:"https://github.com/Mesh/Mesh/tree/v3.4/pkg/provider/kubernetes/ingress/fixtures",children:"examples"})," of the Mesh repository."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);