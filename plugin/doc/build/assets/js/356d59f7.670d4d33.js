"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[7494],{24:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>o,frontMatter:()=>d,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"middlewares/http/digestauth","title":"Mesh DigestAuth Documentation","description":"Mesh Proxy\'s HTTP DigestAuth middleware restricts access to your services to known users. Read the technical documentation.","source":"@site/docs/middlewares/http/digestauth.md","sourceDirName":"middlewares/http","slug":"/middlewares/http/digestauth","permalink":"/doc/docs/middlewares/http/digestauth","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/middlewares/http/digestauth.md","tags":[],"version":"current","frontMatter":{"title":"Mesh DigestAuth Documentation","description":"Mesh Proxy\'s HTTP DigestAuth middleware restricts access to your services to known users. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh ContentType Documentation","permalink":"/doc/docs/middlewares/http/contenttype"},"next":{"title":"Mesh Errors Documentation","permalink":"/doc/docs/middlewares/http/errorpages"}}');var a=s(4848),r=s(8453);const d={title:"Mesh DigestAuth Documentation",description:"Mesh Proxy's HTTP DigestAuth middleware restricts access to your services to known users. Read the technical documentation."},i="DigestAuth",l={},h=[{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Configuration Options",id:"configuration-options",level:2},{value:"<code>users</code>",id:"users",level:3},{value:"<code>usersFile</code>",id:"usersfile",level:3},{value:"<code>realm</code>",id:"realm",level:3},{value:"<code>headerField</code>",id:"headerfield",level:3},{value:"<code>removeHeader</code>",id:"removeheader",level:3}];function c(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"digestauth",children:"DigestAuth"})}),"\n",(0,a.jsx)(t.p,{children:"Adding Digest Authentication"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"BasicAuth",src:s(3241).A+"",width:"2445",height:"554"})}),"\n",(0,a.jsx)(t.p,{children:"The DigestAuth middleware grants access to services to authorized users only."}),"\n",(0,a.jsx)(t.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'# Declaring the user list\nlabels:\n  - "Mesh.http.middlewares.test-auth.digestauth.users=test:Mesh:a2688e031edb4be6a3797f3882655c05,test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"# Declaring the user list\napiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-auth\nspec:\n  digestAuth:\n    secret: userssecret\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'# Declaring the user list\n- "Mesh.http.middlewares.test-auth.digestauth.users=test:Mesh:a2688e031edb4be6a3797f3882655c05,test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'# Declaring the user list\nhttp:\n  middlewares:\n    test-auth:\n      digestAuth:\n        users:\n          - "test:Mesh:a2688e031edb4be6a3797f3882655c05"\n          - "test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'# Declaring the user list\n[http.middlewares]\n  [http.middlewares.test-auth.digestAuth]\n    users = [\n      "test:Mesh:a2688e031edb4be6a3797f3882655c05",\n      "test2:Mesh:518845800f9e2bfb1f1f740ec24f074e",\n    ]\n'})}),"\n",(0,a.jsx)(t.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,a.jsx)(t.p,{children:"!!! tip"}),"\n",(0,a.jsxs)(t.p,{children:["Use ",(0,a.jsx)(t.code,{children:"htdigest"})," to generate passwords."]}),"\n",(0,a.jsx)(t.h3,{id:"users",children:(0,a.jsx)(t.code,{children:"users"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"users"})," option is an array of authorized users. Each user will be declared using the ",(0,a.jsx)(t.code,{children:"name:realm:encoded-password"})," format."]}),"\n",(0,a.jsx)(t.p,{children:'!!! note ""'}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["If both ",(0,a.jsx)(t.code,{children:"users"})," and ",(0,a.jsx)(t.code,{children:"usersFile"})," are provided, the two are merged. The contents of ",(0,a.jsx)(t.code,{children:"usersFile"})," have precedence over the values in ",(0,a.jsx)(t.code,{children:"users"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:["For security reasons, the field ",(0,a.jsx)(t.code,{children:"users"})," doesn't exist for Kubernetes IngressRoute, and one should use the ",(0,a.jsx)(t.code,{children:"secret"})," field instead."]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'labels:\n  - "Mesh.http.middlewares.test-auth.digestauth.users=test:Mesh:a2688e031edb4be6a3797f3882655c05,test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-auth\nspec:\n  digestAuth:\n    secret: authsecret\n\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: authsecret\n  namespace: default\n\ndata:\n  users: |2\n    dGVzdDp0cmFlZmlrOmEyNjg4ZTAzMWVkYjRiZTZhMzc5N2YzODgyNjU1YzA1CnRlc3QyOnRyYWVmaWs6NTE4ODQ1ODAwZjllMmJmYjFmMWY3NDBlYzI0ZjA3NGUKCg==\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'- "Mesh.http.middlewares.test-auth.digestauth.users=test:Mesh:a2688e031edb4be6a3797f3882655c05,test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'http:\n  middlewares:\n    test-auth:\n      digestAuth:\n        users:\n          - "test:Mesh:a2688e031edb4be6a3797f3882655c05"\n          - "test2:Mesh:518845800f9e2bfb1f1f740ec24f074e"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[http.middlewares]\n  [http.middlewares.test-auth.digestAuth]\n    users = [\n      "test:Mesh:a2688e031edb4be6a3797f3882655c05",\n      "test2:Mesh:518845800f9e2bfb1f1f740ec24f074e",\n    ]\n'})}),"\n",(0,a.jsx)(t.h3,{id:"usersfile",children:(0,a.jsx)(t.code,{children:"usersFile"})}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"usersFile"})," option is the path to an external file that contains the authorized users for the middleware."]}),"\n",(0,a.jsxs)(t.p,{children:["The file content is a list of ",(0,a.jsx)(t.code,{children:"name:realm:encoded-password"}),"."]}),"\n",(0,a.jsx)(t.p,{children:'!!! note ""'}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["If both ",(0,a.jsx)(t.code,{children:"users"})," and ",(0,a.jsx)(t.code,{children:"usersFile"})," are provided, the two are merged. The contents of ",(0,a.jsx)(t.code,{children:"usersFile"})," have precedence over the values in ",(0,a.jsx)(t.code,{children:"users"}),"."]}),"\n",(0,a.jsxs)(t.li,{children:["Because it does not make much sense to refer to a file path on Kubernetes, the ",(0,a.jsx)(t.code,{children:"usersFile"})," field doesn't exist for Kubernetes IngressRoute, and one should use the ",(0,a.jsx)(t.code,{children:"secret"})," field instead."]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'labels:\n  - "Mesh.http.middlewares.test-auth.digestauth.usersfile=/path/to/my/usersfile"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-auth\nspec:\n  digestAuth:\n    secret: authsecret\n\n---\napiVersion: v1\nkind: Secret\nmetadata:\n  name: authsecret\n  namespace: default\n\ndata:\n  users: |2\n    dGVzdDokYXByMSRINnVza2trVyRJZ1hMUDZld1RyU3VCa1RycUU4d2ovCnRlc3QyOiRhcHIxJGQ5\n    aHI5SEJCJDRIeHdnVWlyM0hQNEVzZ2dQL1FObzAK\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'- "Mesh.http.middlewares.test-auth.digestauth.usersfile=/path/to/my/usersfile"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'http:\n  middlewares:\n    test-auth:\n      digestAuth:\n        usersFile: "/path/to/my/usersfile"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[http.middlewares]\n  [http.middlewares.test-auth.digestAuth]\n    usersFile = "/path/to/my/usersfile"\n'})}),"\n",(0,a.jsx)(t.p,{children:'??? example "A file containing test/test and test2/test2"'}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-txt",children:"test:Mesh:a2688e031edb4be6a3797f3882655c05\ntest2:Mesh:518845800f9e2bfb1f1f740ec24f074e\n"})}),"\n",(0,a.jsx)(t.h3,{id:"realm",children:(0,a.jsx)(t.code,{children:"realm"})}),"\n",(0,a.jsxs)(t.p,{children:["You can customize the realm for the authentication with the ",(0,a.jsx)(t.code,{children:"realm"})," option. The default value is ",(0,a.jsx)(t.code,{children:"Mesh"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'labels:\n  - "Mesh.http.middlewares.test-auth.digestauth.realm=MyRealm"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-auth\nspec:\n  digestAuth:\n    realm: MyRealm\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'- "Mesh.http.middlewares.test-auth.digestauth.realm=MyRealm"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'http:\n  middlewares:\n    test-auth:\n      digestAuth:\n        realm: "MyRealm"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[http.middlewares]\n  [http.middlewares.test-auth.digestAuth]\n    realm = "MyRealm"\n'})}),"\n",(0,a.jsx)(t.h3,{id:"headerfield",children:(0,a.jsx)(t.code,{children:"headerField"})}),"\n",(0,a.jsxs)(t.p,{children:["You can customize the header field for the authenticated user using the ",(0,a.jsx)(t.code,{children:"headerField"}),"option."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'labels:\n  - "Mesh.http.middlewares.my-auth.digestauth.headerField=X-WebAuth-User"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: my-auth\nspec:\n  digestAuth:\n    # ...\n    headerField: X-WebAuth-User\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'- "Mesh.http.middlewares.my-auth.digestauth.headerField=X-WebAuth-User"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:'http:\n  middlewares:\n    my-auth:\n      digestAuth:\n        # ...\n        headerField: "X-WebAuth-User"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:'[http.middlewares.my-auth.digestAuth]\n  # ...\n  headerField = "X-WebAuth-User"\n'})}),"\n",(0,a.jsx)(t.h3,{id:"removeheader",children:(0,a.jsx)(t.code,{children:"removeHeader"})}),"\n",(0,a.jsxs)(t.p,{children:["Set the ",(0,a.jsx)(t.code,{children:"removeHeader"})," option to ",(0,a.jsx)(t.code,{children:"true"})," to remove the authorization header before forwarding the request to your service. (Default value is ",(0,a.jsx)(t.code,{children:"false"}),".)"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Docker & Swarm"',children:'labels:\n  - "Mesh.http.middlewares.test-auth.digestauth.removeheader=true"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:"apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-auth\nspec:\n  digestAuth:\n    removeHeader: true\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="Consul Catalog"',children:'- "Mesh.http.middlewares.test-auth.digestauth.removeheader=true"\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-yaml",metastring:'tab="File (YAML)"',children:"http:\n  middlewares:\n    test-auth:\n      digestAuth:\n        removeHeader: true\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-toml",metastring:'tab="File (TOML)"',children:"[http.middlewares]\n  [http.middlewares.test-auth.digestAuth]\n    removeHeader = true\n"})})]})}function o(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},3241:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/digestauth-f63b1b641a494dfe2631a85691b472e7.png"},8453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>i});var n=s(6540);const a={},r=n.createContext(a);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);