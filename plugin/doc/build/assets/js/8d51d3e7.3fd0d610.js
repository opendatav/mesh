"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[6494],{370:(e,r,t)=>{t.d(r,{A:()=>s});const s=t.p+"assets/images/errorpages-21f26cb15a397c77649553eb4b0ddf5c.png"},2312:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"reference/routing-configuration/http/middlewares/errorpages","title":"Mesh Errors Documentation","description":"In Mesh Proxy, the Errors middleware returns custom pages according to configured ranges of HTTP Status codes. Read the technical documentation.","source":"@site/docs/reference/routing-configuration/http/middlewares/errorpages.md","sourceDirName":"reference/routing-configuration/http/middlewares","slug":"/reference/routing-configuration/http/middlewares/errorpages","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/errorpages","draft":false,"unlisted":false,"editUrl":"https://github.com/opendatav/mesh/tree/main/packages/create-docusaurus/templates/shared/docs/reference/routing-configuration/http/middlewares/errorpages.md","tags":[],"version":"current","frontMatter":{"title":"Mesh Errors Documentation","description":"In Mesh Proxy, the Errors middleware returns custom pages according to configured ranges of HTTP Status codes. Read the technical documentation."},"sidebar":"tutorialSidebar","previous":{"title":"Mesh DigestAuth Documentation","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/digestauth"},"next":{"title":"Mesh ForwardAuth Documentation","permalink":"/doc/docs/reference/routing-configuration/http/middlewares/forwardauth"}}');var n=t(4848),i=t(8453);const o={title:"Mesh Errors Documentation",description:"In Mesh Proxy, the Errors middleware returns custom pages according to configured ranges of HTTP Status codes. Read the technical documentation."},d=void 0,a={},c=[{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Configuration Options",id:"configuration-options",level:2},{value:"service and HostHeader",id:"service-and-hostheader",level:3},{value:"query",id:"query",level:3}];function l(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"Errors",src:t(370).A+"",width:"2420",height:"664"})}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"errors"})," middleware returns a custom page in lieu of the default, according to configured ranges of HTTP Status codes."]}),"\n",(0,n.jsx)(r.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",metastring:'tab="Structured (YAML)"',children:'# Dynamic Custom Error Page for 5XX Status Code excluding 502 and 504\nhttp:\n  middlewares:\n    test-errors:\n      errors:\n        status:\n          - "500"\n          - "501"\n          - "503"\n          - "505-599"\n        service: error-handler-service\n        query: "/{status}.html"\n\n  services:\n    # ... definition of the error-handler-service\n'})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-toml",metastring:'tab="Structured (TOML)"',children:'# Dynamic Custom Error Page for 5XX Status Code excluding 502 and 504\n[http.middlewares]\n  [http.middlewares.test-errors.errors]\n    status = ["500","501","503","505-599"]\n    service = "error-handler-service"\n    query = "/{status}.html"\n\n[http.services]\n  # ... definition of the error-handler-service\n'})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",metastring:'tab="Labels"',children:'# Dynamic Custom Error Page for 5XX Status Code\nlabels:\n  - "Mesh.http.middlewares.test-errors.errors.status=500,501,503,505-599"\n  - "Mesh.http.middlewares.test-errors.errors.service=error-handler-service"\n  - "Mesh.http.middlewares.test-errors.errors.query=/{status}.html"\n'})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-json",metastring:'tab="Tags"',children:'// Dynamic Custom Error Page for 5XX Status Code excluding 502 and 504\n{\n  // ...\n  "Tags": [\n    "Mesh.http.middlewares.test-errors.errors.status=500,501,503,505-599",\n    "Mesh.http.middlewares.test-errors.errors.service=error-handler-service",\n    "Mesh.http.middlewares.test-errors.errors.query=/{status}.html"\n  ]\n\n}\n\n'})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-yaml",metastring:'tab="Kubernetes"',children:'apiVersion: Mesh.io/v1alpha1\nkind: Middleware\nmetadata:\n  name: test-errors\nspec:\n  errors:\n    status:\n      - "500"\n      - "501"\n      - "503"\n      - "505-599"\n    query: /{status}.html\n    service:\n      name: error-handler-service\n      port: 80\n'})}),"\n",(0,n.jsx)(r.h2,{id:"configuration-options",children:"Configuration Options"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{style:{textAlign:"left"},children:"Field"}),(0,n.jsx)(r.th,{style:{textAlign:"left"},children:"Description"}),(0,n.jsx)(r.th,{style:{textAlign:"left"},children:"Default"}),(0,n.jsx)(r.th,{style:{textAlign:"left"},children:"Required"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{style:{textAlign:"left"},children:(0,n.jsx)(r.code,{children:"status"})}),(0,n.jsxs)(r.td,{style:{textAlign:"left"},children:["Defines which status or range of statuses should result in an error page.",(0,n.jsx)("br",{})," The status code ranges are inclusive (",(0,n.jsx)(r.code,{children:"505-599"})," will trigger with every code between ",(0,n.jsx)(r.code,{children:"505"})," and ",(0,n.jsx)(r.code,{children:"599"}),", ",(0,n.jsx)(r.code,{children:"505"})," and ",(0,n.jsx)(r.code,{children:"599"})," included).",(0,n.jsx)("br",{})," You can define either a status code as a number (",(0,n.jsx)(r.code,{children:"500"}),"), as multiple comma-separated numbers (",(0,n.jsx)(r.code,{children:"500,502"}),"), as ranges by separating two codes with a dash (",(0,n.jsx)(r.code,{children:"505-599"}),"), or a combination of the two (",(0,n.jsx)(r.code,{children:"404,418,505-599"}),")."]}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:"[]"}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{style:{textAlign:"left"},children:(0,n.jsx)(r.code,{children:"service"})}),(0,n.jsxs)(r.td,{style:{textAlign:"left"},children:["The service that will serve the new requested error page.",(0,n.jsx)("br",{})," More information ",(0,n.jsx)(r.a,{href:"#service-and-hostheader",children:"here"}),"."]}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:'""'}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:"No"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{style:{textAlign:"left"},children:(0,n.jsx)(r.code,{children:"query"})}),(0,n.jsxs)(r.td,{style:{textAlign:"left"},children:["The URL for the error page (hosted by ",(0,n.jsx)(r.code,{children:"service"}),").",(0,n.jsx)("br",{})," More information ",(0,n.jsx)(r.a,{href:"#query",children:"here"})]}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:'""'}),(0,n.jsx)(r.td,{style:{textAlign:"left"},children:"No"})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"service-and-hostheader",children:"service and HostHeader"}),"\n",(0,n.jsxs)(r.p,{children:["By default, the client ",(0,n.jsx)(r.code,{children:"Host"})," header value is forwarded to the configured error service.\nTo forward the ",(0,n.jsx)(r.code,{children:"Host"})," value corresponding to the configured error service URL,\nthe ",(0,n.jsx)(r.a,{href:"/doc/docs/routing/services/#pass-host-header",children:(0,n.jsx)(r.code,{children:"passHostHeader"})})," option must be set to ",(0,n.jsx)(r.code,{children:"false"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:['!!!info "Kubernetes"\nWhen specifying a service in Kubernetes (e.g., in an IngressRoute), you need to reference the ',(0,n.jsx)(r.code,{children:"name"}),", ",(0,n.jsx)(r.code,{children:"namespace"}),", and ",(0,n.jsx)(r.code,{children:"port"})," of your Kubernetes Service resource. For example, ",(0,n.jsx)(r.code,{children:"my-service.my-namespace@kubernetescrd"})," (or ",(0,n.jsx)(r.code,{children:"my-service.my-namespace@kubernetescrd:80"}),") ensures that requests go to the correct service and port."]}),"\n",(0,n.jsx)(r.h3,{id:"query",children:"query"}),"\n",(0,n.jsxs)(r.p,{children:["There are multiple variables that can be placed in the ",(0,n.jsx)(r.code,{children:"query"})," option to insert values in the URL."]}),"\n",(0,n.jsx)(r.p,{children:"The table below lists all the available variables and their associated values."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Variable"}),(0,n.jsx)(r.th,{children:"Value"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"{status}"})}),(0,n.jsx)(r.td,{children:"The response status code."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"{url}"})}),(0,n.jsxs)(r.td,{children:["The ",(0,n.jsx)(r.a,{href:"https://pkg.go.dev/net/url#QueryEscape",children:"escaped"})," request URL."]})]})]})]})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>d});var s=t(6540);const n={},i=s.createContext(n);function o(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);